# РОССИЙСКИЙ УНИВЕРСИТЕТ ДРУЖБЫ НАРОДОВ

### Факультет физико-математических и естественных наук 

<br/>
<br/>
<br/>
<br/>

ОТЧЕТ
ПО ЛАБОРАТОРНОЙ РАБОТЕ №2
===============
## Моделирование задачи "Погоня"

<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
дисциплина:  Математическое моделирование

Студент: Койфман Кирилл Дмитриевич

Группа: НПИбд-01-21

<br/>
<br/>
<br/>
<br/>

## Введение.
### Цель работы.
Разработать решение для задачи "Погоня" с помощью математического моделирования на языке Julia.

### Описание задания
На море в тумане катер береговой охраны преследует лодку браконьеров.
Через определенный промежуток времени туман рассеивается, и лодка обнаруживается на расстоянии 19.5 км от катера. Затем лодка снова скрывается в тумане и уходит прямолинейно в неизвестном направлении. Известно, что скорость катера в 4.9 раза больше скорости браконьерской лодки.

### Задачи.
1. Записать уравнение, описывающее движение катера, с начальными условиями для двух случаев (в зависимости от расположения катера относительно лодки в начальный момент времени). 
2. Построить траекторию движения катера и лодки для двух случаев.
3. Найти точку пересечения траектории катера и лодки. 

## Ход работы
### 1 задание
---
Для начала запишем уравнение, описывающее движение катера, с начальными условиями для 2-х случаев:
Определим такие условия:
- $x_{л0}=0$ - место нахождения лодки браконьеров в момент обнаружения катером береговой охраны;
- $t_0=0$ - момент обнаружения катером береговой охраны;
- $x_{к0}=19.5$ - место нахождения катера береговой охраны относительно лодки браконьеров в момент обнаружения лодки.

Также введём полярные координаты:
- $x_{л0}=0 (x_{л0}=\Theta=0)$ - точка обнаружения лодки браконьеров (полюс). В том время как ось $\gamma$ проходит через точку нахождения катера береговой охраны.
<br/>

Для того чтобы катер и лодка всё время были на одном расстоянии от полюса $\Theta$, катер береговой охраны должен двигаться некоторое время прямолинейно, пока не окажется на том же расстоянии от полюса, что и лодка браконьеров. После этого катер береговой охраны должен двигаться вокруг полюса удаляясь от него с той же скоростью, что и лодка 
браконьеров.

Теперь, чтобы найти $x$ (расстояние, после которого катер начнет двигаться вокруг полюса), составим уравнение. Установим, что ререз время $t$ катер и лодка окажутся на одном расстоянии $x$ от полюса $\Theta$, таким образом за это время $t$ лодка пройдёт $x$, а катер $19.5-x$ или $19.5+x$, исходя из начального положения катера относительно $\Theta$. Время, за которое они пройдут это расстояние, вычисляется как $x/v$ или $19.5-x/4.9v$ или $19.5+x/4.9v$, соответсвенно. Получаем эти уравнения:
$$
\frac{x}{v}=\frac{19.5-x}{4.9v},
\frac{x}{v}=\frac{19.5+x}{4.9v} \\
$$

<br/>
И их решения для 2-х случаев:

$$
x_1=5 \\
x_2=3.305
$$

После того, как катер береговой охраны окажется на одном расстоянии от полюса, что и лодка, он должен сменить прямолинейную траекторию и начать двигаться вокруг полюса удаляясь от него со скоростью лодки v.
Для этого разобьём скорость катера на $v_\gamma$ - радиальную скорость (скорость, с которой катер удаляется от полюса, $v_\gamma=\frac{dr}{dt}$) и $v_\tau$ - тангенциальную скорость (линейная скорость вращения катера относительно полюса, $v_\tau=r\frac{d\Theta}{dt}$). При этом необходимо, чтобы скорость $v_\gamma$ была равна скорости лодки, поэтому:

$$\frac{dr}{dt}=v$$

В итоге получаем такую систему дифференциальных уравнений:
$$
\left\{
\begin{aligned}
    \frac{dr}{dt}=v \\
    \sqrt{23.01}v= r\frac{d\Theta}{dt}
\end{aligned}
\right.
$$

Либо при условии №1:
$$
\left\{
\begin{aligned}
    \Theta=0 \\
    r_0=x1=5
\end{aligned}
\right.
$$
Либо при условии №2:
$$
\left\{
\begin{aligned}
    \Theta=-\pi \\
    r_0=x2=3.305
\end{aligned}
\right.
$$

Исключив из этой системы уравнений производную по $t$, получаем такое уравнение:
$$
\frac{dr}{d\Theta}=\frac{r}{\sqrt{23.01}}
$$

Решив данное уравнение с применением начальных условиев, мы получим траекторию движения катера в полярных координатах.

### 2 задание
---
А сейчас построим траекторию движения катера и лодки для двух случаев, написав алгоритм для этого:

```
using Plots 
using DifferentialEquations

s = 19.5
fi = 3 * π / 4
dr(r, p, tetha) = r / sqrt(23.01)
x = (s*10)/39
r = x
tetha = 0
tethaRange = (tetha, tetha + 2*pi)

problem = ODEProblem(dr, r, tethaRange)
solution = solve(problem, Tsit5(), reltol=1e-8, abstol=1e-8)
solution.u[1]

gr()
plot(solution.t[1:21], solution.u[1:21], proj = :polar, line = (:blue, 2), label = "Лодка браконьеров")
plot!([fi, fi+0.000001], [0,10], line = (:red, 1), label = "Катер береговой охраны", legend = :bottomright)

savefig("test1.png")
```
![pic](https://raw.githubusercontent.com/KirillKoifman/study_2023-2024_mathmod/master/labs/lab2/Screenshots/test1.png)
<br/>*РИС.1(Для 1-го случая)*

```
using Plots 
using DifferentialEquations

s = 19.5
fi = 3 * π / 4
dr(r, p, tetha) = r / sqrt(23.01)
x = (s*10)/59
r = x
tetha = -pi
tethaRange = (tetha + 2*pi, tetha)

problem = ODEProblem(dr, r, tethaRange)
solution = solve(problem, Tsit5(), reltol=1e-8, abstol=1e-8)
solution.u[1]

gr()
plot!(solution.t[1:21], solution.u[1:21], proj = :polar, line = (:green, 2), label = "Лодка браконьеров")
plot!([fi, fi+0.000001], [0,10], line = (:red, 1), label = "Катер береговой охраны", legend = :bottomright)

savefig("test2.png")
```
![pic](https://raw.githubusercontent.com/KirillKoifman/study_2023-2024_mathmod/master/labs/lab2/Screenshots/test2.png)
<br/>*РИС.2(Для 2-го случая)*

### 3 задание
---
Найдём точку пересечения траектории катера и лодки для обоих случаев:
Исходя из рис.1, в 1-м случае значение tetha = 2.4, а значение расстояния r = 8.2.

Исходя из рис.2, во 2-м случае значение tetha = 2.3, а значение расстояния r = 2.7.

## Заключение
В ходе продеданной лабораторной работы мной были усвоены навыки решения задачи математического моделирования с применением языка программирования для работы с математическими вычислениями Julia.